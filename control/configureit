#
# configuration used for development purposes on Linux
#
CFLAGS="-Wall -g -O2"
CXXFLAGS="-fuse-cxa-atexit ${CFLAGS}"
export CFLAGS CXXFLAGS

# the -fuse-cxa-atexit seems to be necessary for dynamically loaded 
# C++ modules, but I'm not convinced. The tests still crash when
# unloading the modules
case `uname` in
Linux)
	LDFLAGS="-L/usr/local/lib64 -lusb-1.0"
	if [ -d /usr/include/unicap ]
	then
		CFLAGS="${CFLAGS} -I/usr/include/unicap"
		CXXFLAGS="${CXXFLAGS} -I/usr/include/unicap"
	else if [ -d /usr/local/include/unicap ]
		then
			CFLAGS="${CFLAGS} -I/usr/local/include/unicap"
			CXXFLAGS="${CXXFLAGS} -I/usr/local/include/unicap"
		fi
	fi
	export LDFLAGS CFLAGS CXXFLAGS

	./configure --prefix=`pwd`/root --enable-unicap
	;;
Darwin)
	LDFLAGS="-L/usr/local/lib -lusb-1.0"
	export LDFLAGS
	./configure --prefix=`pwd`/root
	;;
esac
